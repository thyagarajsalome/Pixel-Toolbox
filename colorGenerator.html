<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>RGB Color Generator</title>
    <style>
      body {
        font-family: "Times New Roman", Times, serif;
        margin: 0;
        padding: 0;
        background-color: #f7f7f7;
      }
      .container {
        max-width: 900px;
        margin: 0 auto;
        padding: 20px;
      }
      /* Hero Section */
      .hero {
        background: linear-gradient(135deg, #16c499, #439ceb);
        color: #fff;
        padding: 60px 20px;
        text-align: center;
      }
      .hero h1 {
        margin: 0;
        font-size: 48px;
      }
      .hero p {
        font-size: 20px;
        margin-top: 10px;
      }
      /* Buttons Container */
      .buttons-container {
        margin-bottom: 20px;
        text-align: center;
      }
      .color-button {
        border: 1px dashed gray;
        padding: 10px 20px;
        margin: 5px;
        font-size: 16px;

        border-radius: 4px;

        cursor: pointer;
        transition: background-color 0.2s;
      }
      .color-button:hover {
        color: red;
      }

      .error {
        color: red;
        font-size: 16px;
      }
      /* Generator Section */
      .color-group {
        margin-bottom: 40px;
        padding: 10px;
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 4px;
      }
      .color-group h2 {
        margin-top: 0;
        font-size: 20px;
        margin-bottom: 10px;
      }
      .swatches {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        gap: 10px;
        margin-bottom: 10px;
      }
      .swatch {
        width: 100%;
        height: 80px;
        border: 1px solid #ccc;
        border-radius: 4px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        position: relative;
        padding: 2px;
      }
      .swatch p {
        margin: 2px 0;
        font-size: 10px;
        text-align: center;
        color: #333;
        background: rgba(255, 255, 255, 0.7);
        padding: 2px 4px;
        border-radius: 3px;
      }
      /* Delete Button inside a swatch */
      .delete-btn {
        position: absolute;
        top: 2px;
        right: 4px;
        cursor: pointer;
        color: red;
        font-weight: bold;
        font-size: 16px;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 50%;
        padding: 2px 6px;
      }
      ul.rgb-list {
        list-style-type: none;
        padding: 0;
        font-size: 14px;
        font-family: monospace;
      }
      ul.rgb-list li {
        background: #fff;
        margin: 4px 0;
        padding: 6px;
        border: 1px solid #ccc;
        border-radius: 4px;
      }
      /* Guide Section */
      .guide {
        padding: 20px;
        border-radius: 4px;
        margin-top: 20px;
      }
      .guide h2 {
        display: flex;
        justify-content: center;
        font-size: large;
        margin-top: 0;
      }
      /* Footer */
      footer {
        color: #333;
        padding: 20px 0;
        text-align: center;
        margin-top: 40px;
      }
    </style>
  </head>
  <body>
    <!-- Hero Section -->
    <header class="hero">
      <div class="container">
        <h1>RGB Color Generator</h1>
        <p>Discover unique color palettes for your design projects!</p>
      </div>
    </header>

    <!-- Main Content -->
    <main class="container">
      <!-- Generator Section -->
      <section class="generator">
        <div class="buttons-container">
          <button class="color-button" data-color="gray">Gray</button>
          <button class="color-button" data-color="brown">Brown</button>
          <button class="color-button" data-color="orange">Orange</button>
          <button class="color-button" data-color="red">Red</button>
          <button class="color-button" data-color="pink">Pink</button>
          <button class="color-button" data-color="blue">Blue</button>
          <button class="color-button" data-color="yellow">Yellow</button>
          <button class="color-button" data-color="green">Green</button>
        </div>
        <div id="results"></div>
      </section>

      <!-- Guide Section -->
      <section class="guide">
        <h2>How to Use This Web App</h2>
        <ol>
          <li>Click one of the color buttons above to select a base color.</li>
          <li>
            The app will generate a series of color variations based on the
            selected color.
          </li>
          <li>
            Each swatch displays its RGBA value and, if fully opaque, the
            corresponding RGB value.
          </li>
          <li>
            Use these variations to inspire your design projects or to create
            custom color palettes.
          </li>
        </ol>
      </section>
    </main>

    <!-- Footer -->
    <footer>
      <div class="container">
        <p>&copy; 2025 Color Variations Generator. All rights reserved.</p>
      </div>
    </footer>

    <script>
      /**
       * Parse the user input (CSS color string) and return H, S, L in [0..360, 0..100, 0..100].
       */
      function parseColorToHSL(colorStr) {
        const tempElem = document.createElement("div");
        tempElem.style.color = colorStr;
        document.body.appendChild(tempElem);
        const computedColor = window.getComputedStyle(tempElem).color;
        document.body.removeChild(tempElem);

        const rgbMatch = computedColor.match(
          /rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*[\d.]+)?\)/
        );
        if (!rgbMatch) return null;

        const r = parseInt(rgbMatch[1], 10) / 255;
        const g = parseInt(rgbMatch[2], 10) / 255;
        const b = parseInt(rgbMatch[3], 10) / 255;

        const max = Math.max(r, g, b);
        const min = Math.min(r, g, b);
        let h, s, l;
        l = (max + min) / 2;

        if (max === min) {
          h = 0;
          s = 0;
        } else {
          const diff = max - min;
          s = l > 0.5 ? diff / (2 - max - min) : diff / (max + min);
          switch (max) {
            case r:
              h = (g - b) / diff + (g < b ? 6 : 0);
              break;
            case g:
              h = (b - r) / diff + 2;
              break;
            case b:
              h = (r - g) / diff + 4;
              break;
          }
          h = h * 60;
        }
        return {
          h: Math.round(h),
          s: Math.round(s * 100),
          l: Math.round(l * 100),
        };
      }

      /**
       * Convert HSL (+ alpha) to an RGBA string.
       * h in [0..360], s in [0..100], l in [0..100], a in [0..1].
       */
      function hslToRgbaString(h, s, l, a = 1) {
        s /= 100;
        l /= 100;
        const c = (1 - Math.abs(2 * l - 1)) * s;
        const x = c * (1 - Math.abs(((h / 60) % 2) - 1));
        const m = l - c / 2;
        let rPrime = 0,
          gPrime = 0,
          bPrime = 0;
        if (0 <= h && h < 60) {
          rPrime = c;
          gPrime = x;
        } else if (60 <= h && h < 120) {
          rPrime = x;
          gPrime = c;
        } else if (120 <= h && h < 180) {
          gPrime = c;
          bPrime = x;
        } else if (180 <= h && h < 240) {
          gPrime = x;
          bPrime = c;
        } else if (240 <= h && h < 300) {
          rPrime = x;
          bPrime = c;
        } else if (300 <= h && h < 360) {
          rPrime = c;
          bPrime = x;
        }
        const r = Math.round((rPrime + m) * 255);
        const g = Math.round((gPrime + m) * 255);
        const b = Math.round((bPrime + m) * 255);
        return `rgba(${r}, ${g}, ${b}, ${a})`;
      }

      /**
       * Convert HSL (with a=1) to an RGB string (without alpha).
       */
      function hslToRgbString(h, s, l) {
        s /= 100;
        l /= 100;
        const c = (1 - Math.abs(2 * l - 1)) * s;
        const x = c * (1 - Math.abs(((h / 60) % 2) - 1));
        const m = l - c / 2;
        let rPrime = 0,
          gPrime = 0,
          bPrime = 0;
        if (0 <= h && h < 60) {
          rPrime = c;
          gPrime = x;
        } else if (60 <= h && h < 120) {
          rPrime = x;
          gPrime = c;
        } else if (120 <= h && h < 180) {
          gPrime = c;
          bPrime = x;
        } else if (180 <= h && h < 240) {
          gPrime = x;
          bPrime = c;
        } else if (240 <= h && h < 300) {
          rPrime = x;
          bPrime = c;
        } else if (300 <= h && h < 360) {
          rPrime = c;
          bPrime = x;
        }
        const r = Math.round((rPrime + m) * 255);
        const g = Math.round((gPrime + m) * 255);
        const b = Math.round((bPrime + m) * 255);
        return `rgb(${r}, ${g}, ${b})`;
      }

      /**
       * Ensure the hue is within [0, 360].
       */
      function clampHue(hue) {
        let result = hue % 360;
        if (result < 0) result += 360;
        return result;
      }

      /**
       * Check if two colors (in HSL) are too similar.
       * Alpha is ignored.
       */
      function isSimilarColor(c1, c2, thresholds = { h: 10, s: 10, l: 10 }) {
        let deltaH = Math.abs(c1.h - c2.h);
        if (deltaH > 180) deltaH = 360 - deltaH;
        const deltaS = Math.abs(c1.s - c2.s);
        const deltaL = Math.abs(c1.l - c2.l);
        return (
          deltaH < thresholds.h &&
          deltaS < thresholds.s &&
          deltaL < thresholds.l
        );
      }

      /**
       * Filter an array of color variation objects to remove colors that are too similar.
       */
      function filterSimilarColors(variations) {
        const filtered = [];
        variations.forEach((variation) => {
          if (
            !filtered.some((existing) => isSimilarColor(existing, variation))
          ) {
            filtered.push(variation);
          }
        });
        return filtered;
      }

      /**
       * Generate color variations by shifting hue, saturation, and lightness relative to the base color.
       * Returns an array of objects { h, s, l, a, rgba }.
       */
      function generateColorVariations(baseH, baseS, baseL) {
        const hueOffsets = [-20, -10, 0, 10, 20];
        const saturationOffsets = [-20, -10, 0, 10, 20];
        const lightnessOffsets = [-20, -10, 0, 10, 20];
        const alphaSteps = [0.6, 0.8, 1.0];

        let variations = [];
        hueOffsets.forEach((hOff) => {
          saturationOffsets.forEach((sOff) => {
            lightnessOffsets.forEach((lOff) => {
              alphaSteps.forEach((aVal) => {
                const h = clampHue(baseH + hOff);
                const s = Math.min(100, Math.max(0, baseS + sOff));
                const l = Math.min(100, Math.max(0, baseL + lOff));
                const rgba = hslToRgbaString(h, s, l, aVal);
                variations.push({ h, s, l, a: aVal, rgba });
              });
            });
          });
        });
        return filterSimilarColors(variations);
      }

      /**
       * Generate 100 variations for gray.
       * Returns an array of objects { h, s, l, a, rgba }.
       */
      function generateGrayVariations() {
        let variations = [];
        const fixedSaturation = 10;
        const fixedLightness = 50;
        for (let i = 0; i < 100; i++) {
          let hue = Math.round((360 / 100) * i);
          const rgba = hslToRgbaString(hue, fixedSaturation, fixedLightness);
          variations.push({
            h: hue,
            s: fixedSaturation,
            l: fixedLightness,
            a: 1,
            rgba,
          });
        }
        return filterSimilarColors(variations);
      }

      /**
       * Display the color variations.
       * For each variation, if alpha is 1, both the rgba and corresponding rgb values are shown.
       * Each swatch (color preview card) now includes a delete (×) button.
       */
      function displayAllVariations(allVariations) {
        const resultsContainer = document.getElementById("results");
        resultsContainer.innerHTML = "";
        allVariations.forEach((group) => {
          const groupDiv = document.createElement("div");
          groupDiv.className = "color-group";

          const header = document.createElement("h2");
          header.textContent = `Variations for "${group.color}"`;
          groupDiv.appendChild(header);

          // Create container for swatches and RGB list.
          const swatchesContainer = document.createElement("div");
          swatchesContainer.className = "swatches";
          const list = document.createElement("ul");
          list.className = "rgb-list";

          group.variations.forEach((variation) => {
            // Create swatch card.
            const swatch = document.createElement("div");
            swatch.className = "swatch";
            swatch.style.backgroundColor = variation.rgba;

            // Create delete button for swatch.
            const deleteBtn = document.createElement("span");
            deleteBtn.textContent = "×";
            deleteBtn.classList.add("delete-btn");
            swatch.appendChild(deleteBtn);

            // Create paragraph for RGBA value.
            const rgbaText = document.createElement("p");
            rgbaText.textContent = variation.rgba;
            swatch.appendChild(rgbaText);

            // If opaque, also display RGB value.
            if (variation.a === 1) {
              const rgbText = document.createElement("p");
              rgbText.textContent = hslToRgbString(
                variation.h,
                variation.s,
                variation.l
              );
              swatch.appendChild(rgbText);
            }
            swatchesContainer.appendChild(swatch);

            // Create corresponding list item.
            const li = document.createElement("li");
            li.textContent = variation.rgba;
            list.appendChild(li);

            // When delete button is clicked, remove both swatch and list item.
            deleteBtn.addEventListener("click", function () {
              swatch.remove();
              li.remove();
            });
          });

          groupDiv.appendChild(swatchesContainer);
          groupDiv.appendChild(list);
          resultsContainer.appendChild(groupDiv);
        });
      }

      /**
       * Handle a color button selection.
       */
      function handleColorSelection(color) {
        const resultsContainer = document.getElementById("results");
        resultsContainer.innerHTML = "";
        let variations = [];
        if (color.toLowerCase() === "gray" || color.toLowerCase() === "grey") {
          variations = generateGrayVariations();
        } else {
          const hsl = parseColorToHSL(color);
          if (!hsl) {
            const errorDiv = document.createElement("div");
            errorDiv.className = "error";
            errorDiv.textContent = `Invalid color input: "${color}"`;
            resultsContainer.appendChild(errorDiv);
            return;
          }
          variations = generateColorVariations(hsl.h, hsl.s, hsl.l);
        }
        displayAllVariations([{ color: color, variations: variations }]);
      }

      // Attach event listeners to all color buttons.
      document.querySelectorAll(".color-button").forEach((button) => {
        button.addEventListener("click", function () {
          const selectedColor = this.getAttribute("data-color");
          handleColorSelection(selectedColor);
        });
      });
    </script>
  </body>
</html>
